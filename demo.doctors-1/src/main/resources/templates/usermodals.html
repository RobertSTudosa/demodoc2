<html>
<body>
	<div th:fragment="reAppointmentSelect" class="bd-example"> 
	

	<div class="modal fade"
		id="recurrentAppointment1"
		tabindex=-501 aria-labelledby="exampleModalLabel" aria-hidden="true" style="overflow: auto !important;">

		<div class="modal-dialog modal-xl">
			<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="staticBackdropLabel">Programare
							recurenta - alegeti pacientul</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
				<div class="modal-body">
				<form role="search" class="app-search d-block d-sm-block d-md-block me-3 row"  method="get" th:action="@{/doctor/searchClients}" id="searchAppClient">

								<div class="input-group mb-3">
									<input type="hidden" value="clientSearch" name="search" id="clientSearch">
									<input type="search" placeholder="search clients..." class="form-control mt-0" th:name="keyword" id="keywordModal" >
										<button type="button" id="button-addon1" class="btn btn-sm active" th:attr="onclick=|searchClients()|">
												<i class="fa fa-search"></i>
										</button>
								</div>


								<script type="text/javascript" th:inline="javascript">
									//$("#searchAppClient").submit(function(e) {
									//console.log('preventing enter ');
   									//	 e.preventDefault();
   									//	 searchClients();
									//});
									
									function searchClients() {
										
																			
										//var keywordById = document.getElementById("keywordModal").value; // asta merge
										var keywordById = $("#keywordModal").val();
										console.log('searchClientsModal is searched ' );
										console.log('trying to get keyword by id --> ' + keywordById);
										
										$.ajax({
										
										type: "GET",
                            			url: "/doctor/searchClientsModal?keyword=" + keywordById + "&search=clientSearch",
                            			beforeSend: function () {
                            				$(".preloader").fadeOut();
                            			},
										complete: function () {},					
										success: function (data) {
										//console.log(JSON.stringify(data));	
										
										$("#searchAppClient")[0].reset();
														
										$("#modalSearchClientsWrapper").html(data);	
									},
								
										
										
										
										});
									
									}
                                	
                                
                                </script>

                                
                                
                            </form>
				
				
				<div class="row alert d-flex align-items-center alert-dismissible fade show mx-2 mt-2" id="modalSearchClientsWrapper" >
				<div class="col-md-12 col-lg-12 col-sm-12 tab-pane fade active show" id="search" role="tabpanel" aria-labelledby="future-tab"  th:if="${selectClients}!=null">
                        <div class="white-box">
                            <div class="d-md-flex mb-3">
                                <h3 class="box-title mb-0">Selecteaza candidat : </h3>

                                
                            </div>
                            
							<div class="table-responsive next-appointments" id="searchResultsModal">
                                <table class="table no-wrap" >
                                    <thead>
                                        <tr><th class="border-top-0">select</th>
                                            <th class="border-top-0">#</th>
                                            <th class="border-top-0">Nume</th>
                                            <th class="border-top-0">Email</th>
                                            <th class="border-top-0">Telefon</th>
                                            <th class="border-top-0">Data nasterii</th>
                                        </tr>
                                    </thead>
                                    <tbody  >
                                        <tr th:each="client, iterApp : ${selectClients}"  >
                                        	<td>
                                        			<input type="checkbox" name="myClient" th:id="'selectedClient' + ${client.personId}" 
                                        			th:attr="onChange=|showNextModal('${client.personId}')|">
                                        	</td>
                                            <td th:text="${iterApp.index} + 1">1</td>
                                            <td class="txt-oflo" >
                                            	<a class="d-flex align-items-center profile-pic" type="button" href="#" data-bs-toggle="modal"
                                            	
                                            	th:data-bs-target="'#detailClient' + ${client.personId}">
                                            	
                                            	<!-- replace with detailClient  -->
                                            	<span class="iconify thumb-sm img-circle"  th:if="${client.lastImgId < 1}" 
                                            	
                                            	data-icon="bx:bxs-user-circle" data-inline="false" 
                                        	 style="border: 0.3px solid white;width:40px;height:40px;"></span>
                                        	 
                                        	 <!-- <span class="iconify thumb-sm img-circle"  th:if="${client.lastImgId < 1}"                                            	
                                            	data-icon="bx:bxs-user-circle" data-inline="false" 
                                        	 style="border: 0.3px solid white;width:40px;height:40px;"></span> -->
                                        
                                       
                                        
										<img th:if="${client.lastImgId != null}"
												th:src="@{/doctor/lastImg(personId=${client.getPersonId()})}" 
												class="thumb-sm img-circle" 
												style="border: 0.3px solid white;width:40px;height:40px;object-fit: cover;border-radius: 50%;">
										<span  class="text-black font-medium ms-1" th:text="${client.firstName}">Steave</span></a>
										
										<div th:replace="usermodals :: clientDetails"></div>
										
                                           </td>
                                            <td th:text="${client.email}">EMAIL</td>
                                            <td><span class="text-info" th:text="${client.phone}">0722 222 222</span></td>
                                            <td class="txt-oflo" th:text="${#dates.format(client.BirthDate, 'dd-MM-yyyy')}">April 18, 2021</td>
                                                                                
                                        </tr>
                                        
                                        
                                       	<tr>
                                       		<td class="d-none d-sm-block"></td>
                                       		<td></td>
                                       		<!-- <td class="text-center">
                                       			
                                 				<button type="button" class="btn btn-outline-primary load_more_app align-self-center" th:if="${not #lists.isEmpty(selectClients) OR #lists.size(keywords) > 0}"
													th:attr="onclick=|seeMoreSearchResults('${selectClients[#lists.size(selectClients)-1].personId}','${searchMessage}')|">load more</button>
                           						
                           					</td>         -->
                                        </tr>
                                    </tbody>
                                
                                    
                                </table>
                                
                                
                                </div>
                                
                                 <script type="text/javascript" th:inline="javascript">
                          		
                          		function seeMoreSearchResults(lastPersonId, keyword) {
                          		
                          		console.log(keyword);
                          		console.log('lastPersonId load more search ' + lastPersonId);
                          	
                          		$.ajax({
                            		type: "GET",
                            		url: "/doctor/loadMoreSearchClients?keyword=" + keyword + "&lastPersonId=" + lastPersonId,
                            		beforeSend: function () {
                            			
                            		},
									complete: function () {},					
									success: function (data) {
									//console.log(JSON.stringify(data));	
														
									$("#searchResults").html(data);	
									},
									
									});
									
								}
                          
                          </script>
                          
                           <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button><!-- the close for the alert  -->

                            
                        </div>
                    </div>
                
	
	
	</div>	
             
       
				
				</div>
				
				
				<div class="modal-footer" >
					<div class="text-center mb-5" id="nextModal" >
						<button type="button" class="btn btn-primary" 
								data-bs-target="#recAppoint" data-bs-toggle="modal" data-bs-dismiss="modal">Next</button>								
					</div>
				
				</div>
				
	
				<script type="text/javascript" th:inline="javascript">
					
					var selectedPersonId = null;

					$("#nextModal").hide();
					
					
					function showNextModal(personId){
						selectedPersonId = personId;
						console.log('personId is ' + personId);
						var allCheckboxes = $('input[name=myClient]:checked');
						console.log('allCheckboxes lenght is ' + allCheckboxes.length);

							if(allCheckboxes.length > 0 ){
								console.log('checked');
								$("#nextModal").show();
							} else {
								$("#nextModal").hide();
							
							}
							
												
						var allCheckboxesChecked = $('input[name=myClient]').prop('checked').length;
						console.log('checked checkboxes ' + allCheckboxesChecked);
						
						var selected = $("#selectedClient" + personId);
					}
					
					
					console.log('personId outside functions scope ' + personId);
					
				</script>
				
					
				
					
					
			</div>


		</div>
	</div>
	
	<div class="modal fade"
		id="recAppoint"
		tabindex=-501 aria-labelledby="exampleModalLabel" aria-hidden="true" style="overflow: auto !important;">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
					<div class="modal-header">
						<button type="button" class=" mx-2" data-bs-target="#recurrentAppointment1" data-bs-toggle="modal" data-bs-dismiss="modal"	
							th:attr="onclick=|deleteTempAppointments()|"
							aria-label="Close"><span class="iconify" data-icon="bx:bx-arrow-back"style="font-size: 1,2rem;"></span></button>
						
						<h5 class="modal-title" id="staticBackdropLabel">Programare
							recurenta - efectuati programariile</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" th:attr="onclick=|deleteTempAppointments()|"
							aria-label="Close"></button>
					</div>
						
						
					<script type="text/javascript" th:inline="javascript">
					
						function deleteTempAppointments () {
									 		console.log('personId is passed to deleteTempAppointments() ---->' + selectedPersonId);
									 		
									 		$.ajax ({
									 			type: "GET",
                    							url: "/doctor/deleteTempAppointments?personId=" + selectedPersonId,
							                    beforeSend: function () {
							                    	$(".preloader").fadeOut();
							                    },
												complete: function () {},					
												success: function (data) {
												
													$("#tempAppointList").html(data);
												}
									 		
									 		
									 		});
									 	
									 	}
									 
								
								var modalRecApp = document.getElementById('recAppoint');
								modalRecApp.addEventListener('hidden.bs.modal', deleteTempAppointments);
								
								// close modal on click outside at anywhere
  								//$(document).on('click',function(e){
	    						//	if(!(($(e.target).closest("#recAppoint").length > 0 ) )){
	   							//	 	console.log('IT IS HIDDEN!');
	   							//	}
 								//}); 	
									 	
									 	
					
					
					</script>	
				
			<div class="modal-body">
			
			
		
		
		<!-- ======= Appointment Section ======= -->
		
		<section id="appointment" class="appointment section-bg mb-4">
		<div class="container" data-aos="fade-up">

		<form th:action="@{/doctor/addTempAppointment}" th:object="${appointment}" id="tempAppointForm" method="get" role="form" class="php-email-form" 
			data-aos="fade-up" data-aos-delay="100">
          <div class="row">
            <!-- <div class="col-md-4 form-group" sec:authrorize="isAnonymous()">
              <input type="text" th:field="${appointment.pacientName}" name="name" class="form-control" id="name" placeholder="Numele dvs." required>
            </div> -->
            <div class="col-md-4 form-group mt-3 mt-md-0" sec:authorize="isAnonymous()">
              <input type="email" th:field="${appointment.pacientEmail}" class="form-control" name="email" id="email" placeholder="Email" required>
            </div>
            <div class="col-md-4 form-group mt-3 mt-md-0" sec:authorize="isAnonymous()">
              <input type="tel" th:field="${appointment.pacientPhone}" class="form-control" name="phone" id="phone" placeholder="numarul de telefon" required>
            </div>
          </div>
          <div class="row">
            

            <div class="col-md-4 form-group mt-3">
              <select name="doctor" id="doctor" class="form-select doctor" th:attr="onchange=|(getDoctorBusyDates())|">
                <option th:value=null >Selecteaza Doctor</option>
                <option th:each="doctor : ${doctors}" th:value="${doctor.personId}" id="doctorId" th:text="${doctor.firstName}" >Doctor's name</option>
              
              </select>
              
              <script type="text/javascript" th:inline="javascript">
              	
              		var busyDatesArray = [[${busyDates}]];
   	
              	function getDoctorBusyDates () {
              			console.log("getDoctorBusyDates is calling");
              			var doctorId = $("select.doctor").children("option:selected").val(); //use again in the function select hours by doctor 
              			console.log("doctor's id is selected --> " + doctorId);
              			var dateVal = $("#date").val(); 
              			var now = new Date();
              			
              			if(doctorId > 0 ) {
			
							$.ajax({
							type: "GET",
							url: "/allBusyDates",
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
								console.log(data);
								busyDatesArray = data;
							},
						});
						
							if(dateVal == "") {
              					
              					console.log("date is not selected");
              				
              					} else {
              					
              					console.log("date is selected");              						
              					getTimes();

              					};
							
              			} 
              			
              			if(doctorId === ""){ 
              				
              				$.ajax({
							type: "GET",
							url: "/",
							beforeSend: function () {},
							complete: function () {},					
							success: function () {
								console.log("success");
								busyDatesArray = [[${busyDates}]];
							},
						});
						
						if(dateVal == "") {
              					
              					console.log("date is not selected");
              				
              					} else {
              					
              					console.log("date is selected");              						
              					getTimes();

              					
              					
              					};
              			
              			}
              	
              	}
              
              
              </script>
            </div>
            <div class="col-md-4 form-group mt-3">
              <input type="date" th:field="${appointment.date}"  name="date" class="form-control datepicker" id="date" placeholder="Appointment Date" 
              		th:attr="onchange=|(getTimes())|" readonly required >
              <!--  -->
                          <!--   th:attr="onclick=|insertBusyDates('${busyDates}')|" -->
             <!--  <ul style="display: none;" id="busyDates">
              	<li th:each="date : ${busyDates}" th:value="date">date</li>
              </ul>     -->       
            </div>
           <script type="text/javascript" th:inline="javascript">
           			
					var busyDatesArray = [[${busyDates}]];
					
					console.log(busyDatesArray);
	            	$("#date").datepicker({ 
	            	
	            			beforeShowDay: function(date) {
	            				var string2 = formatDate(date);
						      //var string = jQuery.datepicker.formatDate('yy-mm-dd', date);
						      if (contains(busyDatesArray,string2)) {
						        debugger;
						        return [false, '']
						      } else {
						        var day = date.getDay();
						        return [(day != 0) && (day != 6), ''];
						      }
						    },
	            			minDate: 0,
      						showButtonPanel: true,
	            			inline: true,
						    showOtherMonths: true,
      						dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
	            			changeMonth: true,
							changeYear: true,
	            			dateFormat:'yy-mm-dd' });
	            			
	            	function contains(a, obj) {
					    var i = a.length;
					    while (i--) {
					       if (a[i] === obj) {
					           return true;
					       }
					    }
					    return false;
					}
					
					function formatDate(date) {
					    var d = new Date(date),
					        month = '' + (d.getMonth() + 1),
					        day = '' + d.getDate(),
					        year = d.getFullYear();
					
					    if (month.length < 2) 
					        month = '0' + month;
					    if (day.length < 2) 
					        day = '0' + day;
					
					    return [year, month, day].join('-');
					}				
					
					
			// keep this here in case the datepicker beforeShowDay is not working	
	        //  beforeShowDay: function(date){
       			//			var string = jQuery.datepicker.formatDate('yy-mm-dd', date);
        			//			return [ busyDatesArray.indexOf(string) == -1 ]
    					//	},  	
		          
            		
            </script> 
            
             <div class="col-md-4 form-group mt-3" >
             <!--  <input type="time" th:field="${appointment.appointmentTime}" th:value="${appointment.getFixedTimes()}" name="time" 
              	step="3600" class="form-control datepicker" id="time" placeholder="Ora programarii" required>  -->
              	
               	<select th:name="time" id="time" class="form-select fixedTimes">
              		<option id="optionTime" value="selecteaza ora">Ora</option>
              		<option id="optionTime" th:each="time : ${fixedTimes}" th:text="${time}" th:value="${time}">time</option>
              	
              	
              	</select> 
              
            </div>
            
           <script type="text/javascript" th:inline="javascript">
           		 
           		 function getTimes () {
						

						console.log('calling getTime()');
						
						var dateVal = $("#date").val(); //this is in the getTimes() scope
						var doctorId = $("select.doctor").children("option:selected").val(); //use again in the function select hours by doctor 
              			console.log("doctor's id is selected --> " + doctorId);
						
						if(doctorId > 0) {
						
							console.log("doctor is present");
							$.ajax({
							type: "GET",
							url: "/selectTimeByDateByDoctor?date=" + dateVal + "&doctor=" + doctorId,
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
								console.log(data);
								var select = $("#time");
								select.empty().append('<option value="">Selecteaza ora</option>');
								for(var i = 0; i < data.length; i++) {
									console.log("added the time by date and doctor" + data[i]);
									select.append("<option value='" + data[i] + "'>" + data[i] + "</option>");
								}
								
								
								
							},
							});
						
						};
						
						if(doctorId === "") {
							console.log("doctor is NOT present");
							console.log("dateVal checked is " + dateVal);
							$.ajax({
							type: "GET",
							url: "/selectTimeByDate?date=" + dateVal,
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
							
								console.log(data);
								var select = $("#time");
								select.empty().append('<option value="">Selecteaza ora</option>');
								for(var i = 0; i < data.length; i++) {
									console.log("added the time by date " + data[i]);
									select.append("<option value='" + data[i] + "'>" + data[i] + "</option>");
								}
								
								
								
							},
							
							failure: function (data) {
                    			alert(data);
                			}
						});
							
						
						}
						
												
						
					
					};
            	
            </script>
          </div>
          
          <!-- onclick="(this.type='time')" onblur="(this.type='text')" -->

          <div class="form-group mt-3 d-flex flex-column flex-md-column flex-xl-row justify-content-between g-3">
          	  <div class="col-md-4 form-group mt-0 me-2" >

            <select name="service" id="department" placeholder="Selecteaza tratament" class="form-select" multiple>
                <!-- <option value="">Selecteaza Tratament</option> -->
                <option th:value="Extractie">Extractie</option>
                <option th:value="Plomba">Plomba</option>
                <option th:value="Obturare_de_canal">Obturare de canal</option>
                <option th:value="Detartraj">Detartraj</option>
                <option th:value="Albire">Albire</option>
			</select>
							
			
            </div>
            
            <textarea class="form-control " name="message" rows="5" placeholder="Message (Optional)"></textarea>
            
          </div>
          
         
          
          <div class="text-center mb-5"><button type="button" class="" th:attr="onclick=|addTemporaryAppoint()|">
          		<span class="iconify" data-icon="carbon:add"></span>
          		<span class="badge bg-primary rounded">adaugati programare</button></div>
          
           <script type="text/javascript" th:inline="javascript">
        	        
        	function addTemporaryAppoint() {	
        		console.log('selectedPerson exists ' + selectedPersonId);
        		var doctorId = $("select.doctor").children("option:selected").val();
        		
        		console.log('doctor parameter in place ' + doctorId);
        		var selectedServices = $("select#department").children("option:selected").toArray().map(item => item.text).join();        		
     
     			console.log('selected services are ' + selectedServices);   		
        		var time = $("select#time").children("option:selected").val(); 
        		console.log('time selected is ' + time);
        		
        		var reDate = $("#date").val();
				console.log('date is passed ' + reDate); 
				
				
        		
        		$.ajax({
        			
        			type: "GET",
                    url: "/doctor/addTempAppointment?personId=" + selectedPersonId + "&doctor=" + doctorId + "&service=" + selectedServices + 
                    											"&time=" + time + "&date=" + reDate,
                    beforeSend: function () {
                    	$(".preloader").fadeOut();
                    },
					complete: function () {},					
					success: function (data) {
					//console.log(JSON.stringify(data));
					
						$("#tempAppointForm")[0].reset();
														
						$("#tempAppointList").html(data);
						
					
					
					},
								
        		
        		
        		});
        		
        	
        	}
        
        
        
        
        </script>
						
          
        </form>
        
        		<!-- ================================  insert an alert for each added appointment then when hitting close delete the appointment ===============-->

			
	
					<div >
						<ul  id="tempAppointList" >
							<li th:each="appointment : ${tempAppointments}" th:if="${tempAppointments} != null" style="list-style: none;">
								<div
									class="alert alert-warning d-flex align-items-center alert-dismissible fade show mx-2 mt-2 "
									role="alert" id="tempAppoint"
									style="border-left: 3px solid #3FBBC0;">
									<div class="wrapper">

										<span class="iconify"
											data-icon="icon-park-outline:appointment"
											style="font-size: 1.2rem;"></span>
										<!-- <i class="bi flex-shrink-0 me-2 fas fa-check-circle"></i> -->
										<span class="fw-bold">progamare adaugata: </span> 
										<span
											th:text="' : ' + ${#temporals.format(appointment.date,'dd-MM-yyyy')}">You
											should check your results.</span> 
										 	
											<span
											th:text="' : ' + ${appointment.appointmentTime}">You
											should check your results.</span> <span class="fw-bold">,
											pacient: </span> <span th:text="' ' + ${appointment.pacientName}">You
											should check your results.</span>
											<span class="fw-bold">,
											doctor: </span> <span th:if="${appointment.doctor} != null" th:text="' ' + ${appointment.getDoctorName()}">You
											should check your results.</span>
											 <span class="fw-bold">,
											requested: </span> <span
											th:text="' ' + ${appointment.companyServices} ">You
											should check your results.</span>
									</div>
									
									 <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" th:attr="onclick=|deleteOneTempAppointment('${appointment.appointmentId}')|"></button><!-- the close for the alert  -->
									 
									 <script type="text/javascript" th:inline="javascript">
									 	function deleteOneTempAppointment (appId) {
									 		console.log('appId is passed ---->' + appId);
									 		
									 		$.ajax ({
									 			type: "GET",
                    							url: "/doctor/deleteOneTempAppointment?appId=" + appId,
							                    beforeSend: function () {
							                    	$(".preloader").fadeOut();
							                    },
												complete: function () {},					
												success: function (data) {
												//console.log(JSON.stringify(data));
												
												
													
												
												
												},
									 		
									 		
									 		
									 		
									 		
									 		});
									 	
									 	}
									 
									 
									 </script>
									
								</div>
							</li>

						</ul>



					</div>
        					
		</div>

		</section>
		<div  id="approveAllTemp">
							<div >
								<button type="button" class="btn" id="approveApp" th:attr="onclick=|approveAllTempAppointments()|" data-bs-dismiss="modal">
									<span class="iconify" data-icon="bi:check-all"></span>
									<span class="badge bg-danger rounded">Aprobati
										programarile</span>
								</button>

								


							</div>
							
							
							<script type="text/javascript" th:inline="javascript">
			
				
				
			
				function approveAllTempAppointments() {
				console.log('selectedPerson exists ' + selectedPersonId);
				
					$.ajax({
        			
        			type: "GET",
                    url: "/doctor/approveAllTempApp?personId=" + selectedPersonId,
                    beforeSend: function () {
                    	$(".preloader").fadeOut();
                    },
					complete: function () {},					
					success: function (data) {
					//console.log(JSON.stringify(data));
							
						$("#appointsMadeList").html(data);	
						
					
						}
				
					});
				}
			
			</script>

						</div>
		
		


				</div><!--end div ul de la modal body  -->

		</div>
		</div>
	</div>
	
	
	</div>
</body>
</html>






<html>
<body>
	<div th:fragment="reAppointment" class="modal fade"
		th:id="recurrentAppointment"
		tabindex=-501 aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<!-- ======= Appointment Section ======= -->
				<section id="appointment" class="appointment section-bg mb-4">
					<div class="container" data-aos="fade-up">

						<form th:action="@{/client/remakeAppointment}" th:object="${appointment}"
							method="post" role="form" class="php-email-form"
							data-aos="fade-up" data-aos-delay="100">
							<div class="row">
								<div class="modal-header">
									<h5 class="modal-title" id="staticBackdropLabel">Programare recurenta</h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<div class="modal-body">
									

									<div class="col-md-4 form-group" sec:authrorize="isAnonymous()">
										<input type="text" th:value="${appointment.pacientName}"
											name="pacientName" id="pacientName"
											class="form-control" placeholder="Numele pacientului" required>
									</div>
									
		
									<div class="col-md-4 form-group mt-3 mt-md-0"
										sec:authorize="isAnonymous()">
										<input type="email" th:field="${appointment.pacientEmail}"
											class="form-control" name="email" id="email"
											placeholder="Email" required>
									</div>
									<div class="col-md-4 form-group mt-3 mt-md-0"
										sec:authorize="isAnonymous()">
										<input type="tel" th:field="${appointment.pacientPhone}"
											class="form-control" name="phone" id="phone"
											placeholder="numarul de telefon" required>
									</div>
								</div>
								<div class="row">


									<div class="col-md-4 form-group mt-3">
										<select name="doctor" th:id="doctor + ${appointment.appointmentId}" class="form-select doctor"
											th:attr="onchange=|(getDoctorBusyDates(${appointment.appointmentId}))|">
											<option th:value=null>Selecteaza Doctor</option>
											<option th:each="doctor : ${doctors}"
												th:value="${doctor.personId}" id="doctorId"
												th:text="${doctor.firstName}">Doctor's name</option>

										</select>

										<script type="text/javascript" th:inline="javascript">
              	
              		var busyDatesArray = [[${busyDates}]];
   	
              	function getDoctorBusyDates (appId) {
              			console.log("getDoctorBusyDates is calling");
              			var doctorId = $("select#doctor" + appId).children("option:selected").val(); //use again in the function select hours by doctor 
              			console.log("doctor's id is selected --> " + doctorId);
              			var dateVal = $("#date" + appId).val(); 
              			var now = new Date();
              			
              			if(doctorId > 0 ) {
			
							$.ajax({
							type: "GET",
							url: "/allBusyDates",
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
								console.log(data);
								busyDatesArray = data;
							},
						});
						
							if(dateVal == appId) {
              					
              					console.log("date is not selected");
              				
              					} else {
              					
              					console.log("date is selected");              						
              					getTimes(appId);

              					};
							
              			} 
              			
              			if(doctorId === ""){ 
              				
              				$.ajax({
							type: "GET",
							url: "/",
							beforeSend: function () {},
							complete: function () {},					
							success: function () {
								console.log("success");
								busyDatesArray = [[${busyDates}]];
							},
						});
						
						if(dateVal == appId) {
              					
              					console.log("date is not selected");
              				
              					} else {
              					
              					console.log("date is selected");              						
              					getTimes(appId);

              					
              					
              					};
              			
              			}
              	
              	}
              
              
              </script>
									</div>
									<div class="col-md-4 form-group mt-3">
										<input type="date" th:value="${appointment.date}" th:name="date"
											class="form-control datepicker" th:id="'date' + ${appointment.appointmentId}"
											placeholder="Appointment Date"
											th:attr="onchange=|(getTimes(${appointment.appointmentId}))|" readonly required>
										<!--  -->
										
									</div>
									<script type="text/javascript" th:inline="javascript">
									
									
           			
					var busyDatesArray = [[${busyDates}]];
					
					console.log(busyDatesArray);
	            	$("#date" + [[${appointment.appointmentId}]]).datepicker({ 
	            	
	            			beforeShowDay: function(date) {
		            		  console.log('format date that is the date --> ' + date);
			            	  var string2 = formatDate(date);		
						      //var string = jQuery.datepicker.formatDate('yy-mm-dd', date);
						      if (contains(busyDatesArray,string)) {
						        debugger;
						        return [false, '']
						      } else {
						        var day = date.getDay();
						        return [(day != 0) && (day != 6), ''];
						      }
						    },
	            			minDate: 0,
      						showButtonPanel: true,
	            			inline: true,
						    showOtherMonths: true,
      						dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
	            			changeMonth: true,
							changeYear: true,
	            			dateFormat:'yy-mm-dd' });
	            			
	            	function contains(a, obj) {
					    var i = a.length;
					    while (i--) {
					       if (a[i] === obj) {
					           return true;
					       }
					    }
					    return false;
					}	
					
					function formatDate(date) {
					    var d = new Date(date),
					        month = '' + (d.getMonth() + 1),
					        day = '' + d.getDate(),
					        year = d.getFullYear();
					
					    if (month.length < 2) 
					        month = '0' + month;
					    if (day.length < 2) 
					        day = '0' + day;
					
					    return [year, month, day].join('-');
					}			
					
					
			// keep this here in case the datepicker beforeShowDay is not working	
	        //  beforeShowDay: function(date){
       			//			var string = jQuery.datepicker.formatDate('yy-mm-dd', date);
        			//			return [ busyDatesArray.indexOf(string) == -1 ]
    					//	},  	
		          
            		
            </script>

									<div class="col-md-4 form-group mt-3">
										

										<select th:name="time" th:id="'time' + ${appointment.appointmentId}" class="form-select" required>
											<option id="optionTime" value="selecteaza ora">Ora</option>
											<option id="optionTime" th:each="time : ${fixedTimes}"
												th:text="${time}" th:value="${time}">time</option>


										</select>

									</div>

									<script type="text/javascript" th:inline="javascript">
           		 
           		 function getTimes (appId) {
						

						console.log('calling getTime() from modal');
						
						var dateVal = $("#date" + appId).val(); //this is in the getTimes() scope

						var doctorId = $("select#doctor" + appId).children("option:selected").val(); //use again in the function select hours by doctor 
              			console.log("getTime() modal doctor's id is selected --> " + doctorId);
						
						if(doctorId > 0) {
						
							console.log("doctor is present");
							$.ajax({
							type: "GET",
							url: "/selectTimeByDateByDoctor?date=" + dateVal + "&doctor=" + doctorId,
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
								console.log(data);
								var select = $("#time" + appId);
								select.empty().append('<option value="">Selecteaza ora</option>');
								for(var i = 0; i < data.length; i++) {
									console.log("added the time by date and doctor" + data[i]);
									select.append("<option value='" + data[i] + "'>" + data[i] + "</option>");
								}
								
								
								
							},
							});
						
						};
						
						if(doctorId === "") {
							console.log("doctor is NOT present");
							console.log("dateVal checked is " + dateVal);
							$.ajax({
							type: "GET",
							url: "/selectTimeByDate?date=" + dateVal,
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
							
								console.log(data);
								var select = $("#time" + appId);
								select.empty().append('<option value="">Selecteaza ora</option>');
								for(var i = 0; i < data.length; i++) {
									console.log("added the time by date " + data[i]);
									select.append("<option value='" + data[i] + "'>" + data[i] + "</option>");
								}
								
								
								
							},
							
							failure: function (data) {
                    			alert(data);
                			}
						});
							
						
						}
						
												
						
					
					};
            	
            </script>
								</div>

								<!-- onclick="(this.type='time')" onblur="(this.type='text')" -->

								<div
									class="form-group mt-3 d-flex flex-column flex-md-column flex-xl-row justify-content-between g-3">
									<div class="col-md-4 form-group mt-0 me-2">

										<select name="service" id="department"
											placeholder="Selecteaza tratament" class="form-select"
											multiple>
											<!-- <option value="">Selecteaza Tratament</option> -->
											<option th:value="Extractie">Extractie</option>
											<option th:value="Plomba">Plomba</option>
											<option th:value="Obturare_de_canal">Obturare de
												canal</option>
											<option th:value="Detartraj">Detartraj</option>
											<option th:value="Albire">Albire</option>
										</select>


									</div>

									<textarea class="form-control " name="message" rows="5"
										placeholder="Message (Optional)"></textarea>

								</div>


								<div class="my-3">
									<div class="loading">Loading</div>
									<div class="error-message"></div>
									<div class="sent-message">Your appointment request has
										been sent successfully. Thank you!</div>
								</div>







							</div>
							<div class="modal-footer">

								
								<div class="text-center mb-5">
								<button type="button" class="btn btn-secondary"
									data-bs-dismiss="modal" > Nu modific</button>
								</div>	
									
								<div class="text-center mb-5">
									<button type="submit" >Acceptati modificarile</button>
								</div>

							</div>


						</form>
					</div>

				</section>
			</div>


		</div>
	</div>
</body>
</html>





<html>
<body>
	<div th:fragment="rescheduleAppointment" class="modal fade"
		th:id="'rescheduleAppointment' + ${doctorApp.appointmentId}"
		tabindex=-501 aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<!-- ======= Appointment Section ======= -->
				<section id="appointment" class="appointment section-bg mb-4">
					<div class="container" data-aos="fade-up">

						<form th:action="@{/client/remakeAppointment}" th:object="${doctorApp}"
							method="post" role="form" class="php-email-form"
							data-aos="fade-up" data-aos-delay="100">
							<div class="row">
								<div class="modal-header">
									<h5 class="modal-title" id="staticBackdropLabel">Reprogramare</h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<div class="modal-body">
									
									<input type="hidden" th:value="${doctorApp.appointmentToken}" th:name="appointmentToken" th:id="appointmentToken">

									<div class="col-md-4 form-group" sec:authrorize="isAnonymous()">
										<input type="text" th:value="${doctorApp.pacientName}"
											th:name="pacientName" th:id="pacientName"
											class="form-control" placeholder="Numele dvs." required>
									</div>
									<div class="col-md-4 form-group mt-3 mt-md-0"
										sec:authorize="isAnonymous()">
										<input type="email" th:value="${doctorApp.pacientEmail}"
											class="form-control" th:name="email" th:id="email"
											placeholder="Email" required>
									</div>
									<div class="col-md-4 form-group mt-3 mt-md-0"
										sec:authorize="isAnonymous()">
										<input type="tel" th:value="${doctorApp.pacientPhone}"
											class="form-control" th:name="phone" th:id="phone"
											placeholder="numarul de telefon" required>
									</div>
								</div>
								<div class="row">


									<div class="col-md-4 form-group mt-3">
										<select name="doctor" th:id="doctor + ${doctorApp.appointmentId}" class="form-select doctor"
											th:attr="onchange=|(getDoctorBusyDates(${doctorApp.appointmentId}))|">
											<option th:value=null>Selecteaza Doctor</option>
											<option th:each="doctor : ${doctors}"
												th:value="${doctor.personId}" id="doctorId"
												th:text="${doctor.firstName}">Doctor's name</option>

										</select>

										<script type="text/javascript" th:inline="javascript">
              	
              		var busyDatesArray = [[${busyDates}]];
   	
              	function getDoctorBusyDates (appId) {
              			console.log("getDoctorBusyDates is calling");
              			var doctorId = $("select#doctor" + appId).children("option:selected").val(); //use again in the function select hours by doctor 
              			console.log("doctor's id is selected --> " + doctorId);
              			var dateVal = $("#date" + appId).val(); 
              			var now = new Date();
              			
              			if(doctorId > 0 ) {
			
							$.ajax({
							type: "GET",
							url: "/allBusyDates",
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
								console.log(data);
								busyDatesArray = data;
							},
						});
						
							if(dateVal == appId) {
              					
              					console.log("date is not selected");
              				
              					} else {
              					
              					console.log("date is selected");              						
              					getTimes(appId);

              					};
							
              			} 
              			
              			if(doctorId === ""){ 
              				
              				$.ajax({
							type: "GET",
							url: "/",
							beforeSend: function () {},
							complete: function () {},					
							success: function () {
								console.log("success");
								busyDatesArray = [[${busyDates}]];
							},
						});
						
						if(dateVal == appId) {
              					
              					console.log("date is not selected");
              				
              					} else {
              					
              					console.log("date is selected");              						
              					getTimes(appId);

              					
              					
              					};
              			
              			}
              	
              	}
              
              
              </script>
									</div>
									<div class="col-md-4 form-group mt-3">
										<input type="date" th:value="${doctorApp.date}" th:name="date"
											class="form-control datepicker" th:id="'date' + ${doctorApp.appointmentId}"
											placeholder="Appointment Date"
											th:attr="onchange=|(getTimes(${doctorApp.appointmentId}))|" readonly required>
										<!--  -->
										
									</div>
									<script type="text/javascript" th:inline="javascript">
									
									
           			
					var busyDatesArray = [[${busyDates}]];
					
					console.log(busyDatesArray);
	            	$("#date" + [[${doctorApp.appointmentId}]]).datepicker({ 
	            	
	            			beforeShowDay: function(date) {
						      var string = jQuery.datepicker.formatDate('yy-mm-dd', date);
						      if (contains(busyDatesArray,string)) {
						        debugger;
						        return [false, '']
						      } else {
						        var day = date.getDay();
						        return [(day != 0) && (day != 6), ''];
						      }
						    },
	            			minDate: 0,
      						showButtonPanel: true,
	            			inline: true,
						    showOtherMonths: true,
      						dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
	            			changeMonth: true,
							changeYear: true,
	            			dateFormat:'yy-mm-dd' });
	            			
	            	function contains(a, obj) {
					    var i = a.length;
					    while (i--) {
					       if (a[i] === obj) {
					           return true;
					       }
					    }
					    return false;
					}		
					
					
			// keep this here in case the datepicker beforeShowDay is not working	
	        //  beforeShowDay: function(date){
       			//			var string = jQuery.datepicker.formatDate('yy-mm-dd', date);
        			//			return [ busyDatesArray.indexOf(string) == -1 ]
    					//	},  	
		          
            		
            </script>

									<div class="col-md-4 form-group mt-3">
										

										<select th:name="time" th:id="'time' + ${doctorApp.appointmentId}" class="form-select" required>
											<option id="optionTime" value="selecteaza ora">Ora</option>
											<option id="optionTime" th:each="time : ${fixedTimes}"
												th:text="${time}" th:value="${time}">time</option>


										</select>

									</div>

									<script type="text/javascript" th:inline="javascript">
           		 
           		 function getTimes (appId) {
						

						console.log('calling getTime() from modal');
						
						var dateVal = $("#date" + appId).val(); //this is in the getTimes() scope

						var doctorId = $("select#doctor" + appId).children("option:selected").val(); //use again in the function select hours by doctor 
              			console.log("getTime() modal doctor's id is selected --> " + doctorId);
						
						if(doctorId > 0) {
						
							console.log("doctor is present");
							$.ajax({
							type: "GET",
							url: "/selectTimeByDateByDoctor?date=" + dateVal + "&doctor=" + doctorId,
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
								console.log(data);
								var select = $("#time" + appId);
								select.empty().append('<option value="">Selecteaza ora</option>');
								for(var i = 0; i < data.length; i++) {
									console.log("added the time by date and doctor" + data[i]);
									select.append("<option value='" + data[i] + "'>" + data[i] + "</option>");
								}
								
								
								
							},
							});
						
						};
						
						if(doctorId === "") {
							console.log("doctor is NOT present");
							console.log("dateVal checked is " + dateVal);
							$.ajax({
							type: "GET",
							url: "/selectTimeByDate?date=" + dateVal,
							beforeSend: function () {},
							complete: function () {},					
							success: function (data) {
							
								console.log(data);
								var select = $("#time" + appId);
								select.empty().append('<option value="">Selecteaza ora</option>');
								for(var i = 0; i < data.length; i++) {
									console.log("added the time by date " + data[i]);
									select.append("<option value='" + data[i] + "'>" + data[i] + "</option>");
								}
								
								
								
							},
							
							failure: function (data) {
                    			alert(data);
                			}
						});
							
						
						}
						
												
						
					
					};
            	
            </script>
								</div>

								<!-- onclick="(this.type='time')" onblur="(this.type='text')" -->

								<div
									class="form-group mt-3 d-flex flex-column flex-md-column flex-xl-row justify-content-between g-3">
									<div class="col-md-4 form-group mt-0 me-2">

										<select  th:value="${doctorApp.getCompanyServices()}" th:name="service" id="department"
											placeholder="Selecteaza tratament" class="form-select"
											multiple>
											<!-- <option value="">Selecteaza Tratament</option> -->
											<!-- <option th:id="service" th:each="service : ${doctorApp.getCompanyServices()}" th:value="${service}">Extractie</option> -->
											<option th:value="Extractie" th:name="Extractie" th:id="Extractie" 
												th:select="${#strings.contains(doctorApp.getStringCompanyServicesNames(),&quot;Extractie&quot;)}">Extractie</option>
												
											<option th:value="Plomba" th:name="Plomba" th:id="Plomba" 
												th:select="${#strings.contains(doctorApp.getStringCompanyServicesNames(),&quot;Plomba&quot;)}">Plomba</option>
											<option th:value="Obturare_de_canal" th:name="Obturare_de_canal" th:id="Obturare_de_canal"
												th:selected="${#strings.contains(doctorApp.getStringCompanyServicesNames(),&quot;Obturare_de_canal&quot;)}">Obturare de
												canal</option>
											<option th:value="Detartraj" th:name="Detartraj" th:id="Detartraj"
												th:selected="${#strings.contains(doctorApp.getStringCompanyServicesNames(),&quot;Detartraj&quot;)}">Detartraj</option>
											<option th:value="Albire" th:name="Albire" th:id="Albire"
												th:selected="${#strings.contains(doctorApp.getStringCompanyServicesNames(),&quot;Albire&quot;)}">Albire</option>
										</select>


									</div>

									<textarea class="form-control " name="message" rows="5"
										placeholder="Message (Optional)"></textarea>

								</div>


								<div class="my-3">
									<div class="loading">Loading</div>
									<div class="error-message"></div>
									<div class="sent-message">Your appointment request has
										been sent successfully. Thank you!</div>
								</div>







							</div>
							<div class="modal-footer">

								
								<div class="text-center mb-5">
								<button type="button" class="btn btn-secondary"
									data-bs-dismiss="modal" > Nu modific</button>
								</div>	
									
								<div class="text-center mb-5">
									<button type="submit" >Acceptati modificarile</button>
								</div>

							</div>


						</form>
					</div>

				</section>
			</div>


		</div>
	</div>
</body>
</html>



<html>
<body>
<div th:fragment="cancelAppointment" class="modal fade" th:id="'cancelAppointment' + ${doctorApp.appointmentId}"  tabindex=-501 aria-labelledby="exampleModalLabel" 
		aria-hidden="true"  data-bs-backdrop="static" data-bs-keyboard="false">
<div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Anuleaza progamarea</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" >
        <p>Esti sigur ca vrei sa anulezi programarea din data de : <span th:text="${#temporals.format(doctorApp.date, 'dd-MM-yyyy')}"></span> de la ora 
        	<span th:text="${doctorApp.appointmentTime} + ' ?'"></span></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Nu</button>
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" th:attr="onclick=|cancelAppointment('${doctorApp.getAppointmentToken}')|">Da, anuleaza</button>
        <script type="text/javascript" th:inline="javascript">
        
        	function cancelAppointment(appToken) {
        		console.log('canceling the appointment from the client');
        		console.log('canceling the appointment with token ' + appToken);
        		$.ajax({
						type: "GET",
                        url: "/client/cancelAppointment?appToken=" + appToken,
                        beforeSend: function () {},
						complete: function () {},					
						success: function (data) {
						//console.log(JSON.stringify(data));	
														
						$("#clientfutureAppointments").html(data);
						$("#canceledClientAppointments").html(data);
						
						},
	                            				
                            						
                 });
        	
        	}
        
        </script>
      </div>
    </div>
  </div>



</div>

</body>
</html>



<html>
<body>

<div th:fragment="detailAppointment" class="modal fade" th:id="'detailAppointment' + ${doctorApp.appointmentId}"  tabindex=-501 aria-labelledby="exampleModalLabel" aria-hidden="true" >
<div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
       <div class="modal-title" id="exampleModalLabel"></div>
       	<button type="button" class="btn btn-secondary close" data-bs-dismiss="modal"
						aria-label="Close" ><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" >
      
       <section id="about" class="about" sec:authorize="hasAuthority('PACIENT')">
      <div class="container" data-aos="fade-up">

        <div class="section-title">
          <h2 th:text="'Doctorul dvs: ' + ${doctorApp.getDoctorName()}">Programarea dvs</h2>
          <p class="text-wrap"> Message with the appointment: <span th:if="${doctorApp.canceled}" class="text-danger"> Aceasta progamare este anulata! </span> </p>
        </div>

        <div class="row">
          <div class="col-lg-6" data-aos="fade-right">
									<a class="d-flex align-items-center profile-pic" type="button"
										href="#" data-bs-toggle="modal"
										th:data-bs-target="'#detailAppointment' + ${doctorApp.appointmentId}">
										<span class="iconify img-fluid"
										th:if="${doctorApp.doctor == null OR doctorApp.doctor.lastImgId < 1}"
										data-icon="bx:bxs-user-rectangle" data-inline="false"
										style="font-size:14rem;"></span>

										<span class="iconify img-fluid"
										th:if="${doctorApp.doctor != null AND doctorApp.doctor.lastImgId < 1}"
										data-icon="bx:bxs-user-rectangle" data-inline="false"
										style="font-size:14rem;"></span>



										<img
										th:if="${doctorApp.doctor != null AND doctorApp.doctor.lastImgId != null}"
										th:src="@{/doctor/lastImg(personId=${doctorApp.doctor.getPersonId()})}"
										class=" img-fluid"
										style="border: 0.3px solid white; object-fit: cover;border-radius: 3%;">
										
									</a>
								</div>
          <div class="col-lg-6 pt-4 pt-lg-0 content" data-aos="fade-left">
            <h3 class="text-wrap">Detaliile programarii: </h3>
            <p class="fst-italic text-wrap" >
             
            </p>
            <ul>
              <li ><i class="bi bi-check-circle"></i> Data programarii : <strong><span th:text="${#temporals.format(doctorApp.date, 'dd-MM-yyyy')}" ></span></strong></li>
              <li ><i class="bi bi-check-circle"></i> Ora programarii : <span th:text="${doctorApp.appointmentTime}"></span></li>
              <li><i class="bi bi-check-circle"></i> Doctorul dvs : <span th:if="${doctorApp.doctor} != null" th:text="${doctorApp.doctor.firstName}"></span></li>
              <li>
              		<ul > 
	              		<li th:each="service : ${doctorApp.getCompanyServices()}"><i class="bi bi-check-circle"></i> Procedura dorita : <span th:text="${service.name} + ' '"></span></li>
              		</ul>
              		
            </ul>
            
            <h3 class="text-wrap">Detaliile doctorului: </h3>
            <p class="text-wrap" th:if="${doctorApp.doctor == null}">
             	Nu ati selectat un doctor pentru programarea dvs. Acesta va fi atribuit acestei programari in functie de disponibilitatea noastra. Va multumim! 
            </p>
            
            <p class="text-wrap" th:if="${doctorApp.doctor != null}">
             	Detaliile doctorului fac parte din politica GDPR a companiei si implicit din codul european ce o reglementeaza. Va rugam utilizati detaliile doctorului doar in scopul acestei aplicatii.
            </p>
            
            <ul>
              <!-- <li th:if="${doctorApp.doctor != null}"><i class="bi bi-check-circle"></i> Data nasterii : <strong><span th:text="${#dates.format(doctorApp.pacient.BirthDate, 'dd-MM-yyyy')}" ></span></strong></li> -->
              <li th:if="${doctorApp.doctor != null}"><i class="bi bi-check-circle"></i> Telefon : <span th:text="${doctorApp.getDoctorName()}"></span></li>
              <li th:if="${doctorApp.doctor != null}"><i class="bi bi-check-circle"></i> Email : <span th:text="${doctorApp.doctor.email}"></span></li>
              <!-- ============= Number of appointments to implement ===========  -->
              <!-- <li th:if="${doctorApp.doctor != null}"><i class="bi bi-check-circle"></i> Number of appointments with this doctor : <span th:text="${#lists.size(doctorApp.pacient.getDocAppointments())}"></span></li> -->
              		
              		
            </ul>
            
          </div>
        </div>

      </div>
    </section><!-- End About Us Section -->
	
      
      <section id="about" class="about" sec:authorize="hasAuthority('DOCTOR')">
      <div class="container" data-aos="fade-up">

        <div class="section-title">
          <h2 th:text="${doctorApp.pacientName}">Programarea dvs</h2>
          <p class="text-wrap" > Message with the appointment: </p>
        </div>

        <div class="row">
          <div class="col-lg-6" data-aos="fade-right">
									<a class="d-flex align-items-center profile-pic" type="button"
										href="#" data-bs-toggle="modal"
										th:data-bs-target="'#detailAppointment' + ${doctorApp.appointmentId}">
										<span class="iconify img-fluid"
										th:if="${doctorApp.pacient == null OR doctorApp.pacient.lastImgId < 1}"
										data-icon="bx:bxs-user-rectangle" data-inline="false"
										style="font-size:14rem;"></span>

										<span class="iconify img-fluid"
										th:if="${doctorApp.pacient != null AND doctorApp.pacient.lastImgId < 1}"
										data-icon="bx:bxs-user-rectangle" data-inline="false"
										style="font-size:14rem;"></span>



										<img
										th:if="${doctorApp.pacient != null AND doctorApp.pacient.lastImgId != null}"
										th:src="@{/doctor/lastImg(personId=${doctorApp.pacient.getPersonId()})}"
										class=" img-fluid"
										style="border: 0.3px solid white; object-fit: cover;border-radius: 3%;">
										
									</a>
								</div>
          <div class="col-lg-6 pt-4 pt-lg-0 content" data-aos="fade-left">
            <h3 class="text-wrap">Detaliile programarii: </h3>
            <p class="fst-italic text-wrap" >
             
            </p>
            <ul>
              <li ><i class="bi bi-check-circle"></i> Data programarii : <strong><span th:text="${#temporals.format(doctorApp.date, 'dd-MM-yyyy')}" ></span></strong></li>
              <li ><i class="bi bi-check-circle"></i> Ora programarii : <span th:text="${doctorApp.appointmentTime}"></span></li>
              <li><i class="bi bi-check-circle"></i> Doctorul dvs : <span th:if="${doctorApp.doctor} != null" th:text="${doctorApp.doctor.firstName}"></span></li>
              <li>
              		<ul > 
	              		<li th:each="service : ${doctorApp.getCompanyServices()}"><i class="bi bi-check-circle"></i> Procedura dorita : <span th:text="${service.name} + ' '"></span></li>
              		</ul>
              		
            </ul>
            
            <h3 class="text-wrap">Detaliile pacientului: </h3>
            <p class="text-wrap" th:if="${doctorApp.pacient == null}">
             	Pacientul aceste nu are inca un cont in aplicatia noastra. 
            </p>
            
            <p class="text-wrap" th:if="${doctorApp.pacient != null}">
             	Detaliile pacientului fac parte din politica GDPR a companiei si implicit din codul european ce o reglementeaza. Va rugam utilizati detaliile pacientului doar in scopul acestei aplicatii.
            </p>
            
            <ul>
              <li th:if="${doctorApp.pacient != null}"><i class="bi bi-check-circle"></i> Data nasterii : <strong><span th:text="${#dates.format(doctorApp.pacient.BirthDate, 'dd-MM-yyyy')}" ></span></strong></li>
              <li th:if="${doctorApp.pacient != null}"><i class="bi bi-check-circle"></i> Telefon : <span th:text="${doctorApp.pacient.phone}"></span></li>
              <li th:if="${doctorApp.pacient != null}"><i class="bi bi-check-circle"></i> Email : <span th:text="${doctorApp.pacient.email}"></span></li>
              <li th:if="${doctorApp.pacient != null}"><i class="bi bi-check-circle"></i> Number of appointments : <span th:text="${#lists.size(doctorApp.pacient.getPacientAppointments())}"></span></li>
              		
              		
            </ul>
            
          </div>
        </div>

      </div>
    </section><!-- End About Us Section -->
	
	 
     

		</div>
 
 		  
     


		</div>
 		
 
	</div>
  </div>



</body>
</html>


<html>
<body>

<div th:fragment="clientDetails" class="modal fade" th:id="'detailClient' + ${client.personId}"  tabindex=-501 aria-labelledby="exampleModalLabel" aria-hidden="true" >
<div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
       <div class="modal-title" id="exampleModalLabel"></div>
       	<button type="button" class="btn btn-secondary close" data-bs-dismiss="modal"
						aria-label="Close" ><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" >
      
     
      
      <section id="about" class="about" sec:authorize="hasAuthority('DOCTOR')">
      <div class="container" data-aos="fade-up">

        <div class="section-title">
          <h2 th:text="${client.firstName}">Programarea dvs</h2>
          <p class="text-wrap" > Numar total de progamari :  <span th:text="${#lists.size(client.getPacientAppointments())}"></span></p>
        </div>

        <div class="row">
          <div class="col-lg-6" data-aos="fade-right">
									<a class="d-flex align-items-center profile-pic" type="button"
										href="#" data-bs-toggle="modal"
										th:data-bs-target="'#detailClient' + ${client.personId}">
										<span class="iconify img-fluid"
										th:if="${client.lastImgId < 1}"
										data-icon="bx:bxs-user-rectangle" data-inline="false"
										style="font-size:14rem;"></span>

										<!-- <span class="iconify img-fluid"
										th:if="${client.lastImgId < 1}"
										data-icon="bx:bxs-user-rectangle" data-inline="false"
										style="font-size:14rem;"></span> -->



										<img
										th:if="${client.lastImgId != null}"
										th:src="@{/doctor/lastImg(personId=${client.getPersonId()})}"
										class=" img-fluid"
										style="border: 0.3px solid white; object-fit: cover;border-radius: 3%;">
										
									</a>
								</div>
          <div class="col-lg-6 pt-4 pt-lg-0 content" data-aos="fade-left">
            
            
            
            
            <h3 class="text-wrap">Detaliile pacientului: </h3>
            <p class="text-wrap" th:if="${client == null}">
             	Pacientul aceste nu are inca un cont in aplicatia noastra. 
            </p>
            
            <p class="text-wrap fst-italic" th:if="${client != null}">
             	Detaliile pacientului fac parte din politica GDPR a companiei si implicit din codul european ce o reglementeaza. Va rugam utilizati detaliile pacientului doar in scopul acestei aplicatii.
            </p>
            
            <ul th:if="${client != null}">
              <li ><i class="bi bi-check-circle"></i> Data nasterii : <strong><span th:text="${#dates.format(client.BirthDate, 'dd-MM-yyyy')}" ></span></strong></li>
              <li ><i class="bi bi-check-circle"></i> Telefon : <span th:text="${client.phone}"></span></li>
              <li ><i class="bi bi-check-circle"></i> Email : <span th:text="${client.email}"></span></li>
             
              		
              		
            
            </ul>
            
            
            <h3 class="text-wrap">Istoricul progamariilor: </h3>
            <p class="fst-italic text-wrap" >
             Ultima programare : <span th:if="${not #lists.isEmpty(client.getPacientAppointments())}" th:text="${client.getPacientAppointments()[#lists.size(client.getPacientAppointments())-1].date}"></span>
            </p>
            
            <!-- <ul>
              <li ><i class="bi bi-check-circle"></i> Data programarii : <strong><span th:text="${#temporals.format(doctorApp.date, 'dd-MM-yyyy')}" ></span></strong></li>
              <li ><i class="bi bi-check-circle"></i> Ora programarii : <span th:text="${doctorApp.appointmentTime}"></span></li>
              <li><i class="bi bi-check-circle"></i> Doctorul dvs : <span th:if="${doctorApp.doctor} != null" th:text="${doctorApp.doctor.firstName}"></span></li>
              <li>
              		<ul > 
	              		<li th:each="service : ${doctorApp.getCompanyServices()}"><i class="bi bi-check-circle"></i> Procedura dorita : <span th:text="${service.name} + ' '"></span></li>
              		</ul>
              		
            </ul> -->
            
          </div>
        </div>

      </div>
    </section><!-- End About Us Section -->
	
	 
     

		</div>
 
 		  
     


		</div>
 		
 
	</div>
  </div>



</body>
</html>

<html>
<body>


 <div th:fragment="registerForm" class="modal fade " id="registerNewUserForm" tabindex=-201 aria-labelledby="exampleModalLabel" aria-hidden="true">

  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
       <div class="modal-title" id="exampleModalLabel"></div>
       	<button type="button" class="btn btn-secondary close" data-bs-dismiss="modal"
						aria-label="Close" ><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
      <!--  ======= Login Section ======= -->
					<section id="appointment" class="appointment section-bg">
						<div class="container" data-aos="fade-up">

							<div class="section-title">
<!-- 								<h2>Easy create an account</h2> -->
								<h2>Creati un cont cu usurinta</h2>
								
								<!-- <p>We need a few details from you to create an account. With this account you can make appointments
									easily and see your history with our practice. The stuff will also identify easily and 
									confirm your appointment. 
									</p> -->
								<p>Avem nevoie de cateva detalii pentru a crea un cont cu care veti putea face
								 programari cu mai multa usurinta si de asemenea puteti vedea istoricul consultatiilor si tratamentelor dvs.
								 De asemenea va vom putea identifica cu usurinta pentru viitoarele programari.</p>	
							</div>

							<form th:action="@{/user/save}" method="post" role="form" th:object="${userAccount}"
								class="php-email-form" data-aos="fade-up" data-aos-delay="100">
								
								 <input type="hidden" th:field="${userAccount.userId}" /> <input type="hidden" th:field="${person.personId}" />
								 
								<div class="row">
								
									<div class="col-md-4 form-group mt-3 mt-md-0">
										<input th:field="${userAccount.email}" 
											type="email" class="form-control" name="email" autocomplete="off"
											 placeholder="adresa de email" required>
											<!-- <input type="hidden" th:field="${userAccount.username}" th:value="${userAccount.email}"> -->
									</div>
									
								
									<div class="col-md-4 form-group mt-3 mt-md-0">
										<input th:field="${userAccount.password}" type="password" class="form-control" 
											 placeholder="parola" required>
									</div>
									<div class="col-md-4 form-group mt-3 mt-md-0">
										<input type="password" class="form-control" 
											placeholder="verificare parola" required>
									</div>
								</div>
								<div class="row">
								
									<div class="col-md-4 form-group">
										<input th:field="${person.firstName}" 
											type="text" name="name" class="form-control" 
											placeholder="nume si prenume" required>
									</div>
									
									
									<div class="col-md-4 form-group mt-0">
										<input th:field="${person.birthDate}" 
											onclick="(this.type='date')" onblur="(this.type='text')"
											type="datetime" name="date"
											class="form-control datepicker" 
											placeholder="Data nasterii" required>
									</div>
									
									<div class="col-md-4 form-group mt-3 mt-md-0">
										<input type="tel" class="form-control" name="phone" 
											placeholder="numarul de telefon" required>
									</div>
								</div>

								<div class="form-group mt-3">
									<textarea class="form-control" name="message" rows="5"
										placeholder="Message (Optional)"></textarea>
								</div>
								<div class="my-3">
									<div class="loading">Loading</div>
									<div class="error-message"></div>
									<div class="sent-message">Your appointment request has
										been sent successfully. Thank you!</div>
								</div>


								<div class="text-center">
									<button type="submit">Creati contul</button>
								</div>

							</form>







						</div>
					</section>
					<!-- End Appointment Section -->
				</div>
    </div>
  </div>
  
	 
	
	

</div>


</body>
</html>

<html>
<body>


 <div th:fragment="uploadProfilePic" class="modal fade " id="uploadProfilePic" tabindex=201 aria-labelledby="exampleModalLabel" aria-hidden="true">

  <div class="modal-dialog ">
    <div class="modal-content modal-sm" style="width: 280px; height: auto;">
      <div class="modal-header">
       <div class="modal-title" id="exampleModalLabel"></div>
       	<button type="button" class="btn btn-secondary close" data-bs-dismiss="modal"
						aria-label="Close" ><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
      			<!--  ======= Upload Section ======= -->
					<section id="appointment" class="appointment section-bg">
						<div class="card" style="width: 15rem;">
						<form id="uploadFiles" name="uploadFiles" method="POST"
									th:action="@{/doctor/addProfileImg}"
									encType="multipart/form-data">
									

									
							<!-- Label tag is making all the work. It is acting like a cover button -->
							<div th:if="${#lists.isEmpty(lastPicList)}">
							
							<label for="img">
								<span class="iconify card-img"   data-icon="bx:bxs-user-rectangle" data-inline="false" style="font-size: 14rem;"></span>
								<span class="iconify card-img-overlay d-flex flex-column justify-content-end align-self-end"
											data-icon="iconoir:one-finger-select-hand-gesture"
											data-inline="false" data-rotate="180deg" style="background-color: white;opacity: 0.6; font-size: 3rem; height: 70%; width:100%; "></span>	
							</label>
							
							<input type="file" name="img" id="img" style="display: none;">
							
							</div>


								<div th:if="${not #lists.isEmpty(lastPicList)}">
									<label for="img"> 

										<img
										
										th:src="@{/doctor/img(imgId=${lastPicList[#lists.size(lastPicList)-1].picId})}"
										class="img-circle img-fluid card-img" style="size: 20%;">
									
										<span class="iconify card-img-overlay d-flex flex-column justify-content-end align-self-end"
											data-icon="iconoir:one-finger-select-hand-gesture"
											data-inline="false" data-rotate="180deg" style="background-color: white;opacity: 0.6; font-size: 3rem; height: 10%; width:100%; "></span>	
									

									</label> <input type="file" name="img" id="img" style="display: none;">

									
								</div>

								
											
																	
									

								<div class="card-body">
						    <h5 class="card-title">Schimba poza de profil</h5>
						    <p class="card-text">Poza aleasa va fi expusa in dreptul numelui dvs. pe pagina de prezentare.</p>
						  </div>
						 <!--  <ul class="list-group list-group-flush">
						    <li class="list-group-item">Cras justo odio</li>
						    <li class="list-group-item">Dapibus ac facilisis in</li>
						    <li class="list-group-item">Vestibulum at eros</li>
						  </ul> -->
						  <div class="card-body">
						   <!--  <a href="#" class="card-link">Card link</a> -->
								
									
									<button type="submit" class="card-link btn btn-success">

										<p>upload</p>

									</button>
									
									</div>

								</form>

							</div>
						</div>
						
						<script type="text/javascript" th:inline="javascript">
						
							$(':input[type=file]').change( function(event) {
								var tmppath = URL.createObjectURL(event.target.files[0]);
							    //get parent using closest and then find img element
								$(this).closest("div").find("img").attr('src',tmppath);
							});
													
						</script>
					</section>
					<!-- End Appointment Section -->
				</div>
    </div>
  </div>
  


</body>
</html>